<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Heroes Vs Villains</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
</head>

<body>
  <div id="overlay">
      <div class="fightThing kapow"></div>
      <div class="fightThing bam"></div>
      <div class="fightThing thwack"></div>
      <div class="fightThing smack"></div>
      <div class="fightThing pow"></div>
  </div>
  <div id="winner">And the winner is: <span class="winner_name"></span></div>
  <div id="quote"></div>

    <div class="main-wrapper">

        <div class="card jesus" data-name="Jesus">
            <div class="face front">
                <img class="logo" src="cards/jesus-front.png" />
                <h2>
                    <small>Jesus</small>
                </h2>
            </div>
            <div class="face back">
                <img src="cards/jesus-back.png" />
            </div>
        </div>
        <div class="card satan" data-name="Devil">
          <div class="face front">
              <img class="logo" src="cards/satan-front.png" />
              <h2>
                  <small>Satan</small>
              </h2>
          </div>
          <div class="face back">
              <img src="cards/satan-back.png" />
          </div>
        </div>
        <div class="card batman" data-name="Batman">
          <div class="face front">
              <img class="logo" src="cards/batman-front.png" />
              <h2>
                  <small>Batman</small>
              </h2>
          </div>
          <div class="face back">
              <img src="cards/batman-back.png" />
          </div>
        </div>
        <div class="card joker" data-name="Joker">
          <div class="face front">
              <img class="logo" src="cards/joker-front.png" />
              <h2>
                  <small>The Joker</small>
              </h2>
          </div>
          <div class="face back">
              <img src="cards/joker-back.png" />
          </div>
        </div>
        <div class="card trump" data-name="Trump">
          <div class="face front">
              <img class="logo" src="cards/trump-front.png" />
              <h2>
                  <small>Donald Trump</small>
              </h2>
          </div>
          <div class="face back">
              <img src="cards/trump-back.png" />
          </div>
        </div>
        <div class="card farage" data-name="nigel-farage">
          <div class="face front">
              <img class="logo" src="cards/farage-front.png" />
              <h2>
                  <small>Nigel Farage</small>
              </h2>
          </div>
          <div class="face back">
              <img src="cards/farage-back.png" />
          </div>
        </div>
        <div class="card starks" data-name="The-Starks">
          <div class="face front">
              <img class="logo" src="cards/stark-front.png" />
              <h2>
                  <small>The Starks</small>
              </h2>
          </div>
          <div class="face back">
              <img src="cards/stark-back.png" />
          </div>
        </div>
        <div class="card lanisters" data-name="The-lanisters">
          <div class="face front">
              <img class="logo" src="cards/lanister-front.png" />
              <h2>
                  <small>The Lanisters</small>
              </h2>
          </div>
          <div class="face back">
              <img src="cards/lanister-back.png" />
          </div>
        </div>
        <div class="card bieber" data-name="J-Bieber">
            <div class="face front">
                <img class="logo" src="cards/bieber-front.png" />
                <h2>
                    <small>Justin Bieber</small>
                </h2>
            </div>
            <div class="face back">
                <img src="cards/bieber-back.png" />
            </div>
          </div>
          <div class="card lemongrab" data-name="Lemon-Grab">
              <div class="face front">
                  <img class="logo" src="cards/lemongrab-front.png" />
                  <h2>
                      <small>Lemongrab</small>
                  </h2>
              </div>
              <div class="face back">
                  <img src="cards/lemongrab-back.png" />
              </div>
            </div>
            <div class="card finn" data-name="Finn">
                <div class="face front">
                    <img class="logo" src="cards/finn-front.png" />
                    <h2>
                        <small>Finn</small>
                    </h2>
                </div>
                <div class="face back">
                    <img src="cards/finn-back.png" />
                </div>
              </div>
              <div class="card berry" data-name="mary-berry">
                  <div class="face front">
                      <img class="logo" src="cards/berry-front.png" />
                      <h2>
                          <small>Mary Berry</small>
                      </h2>
                  </div>
                  <div class="face back">
                      <img src="cards/berry-back.png" />
                  </div>
                </div>

        <a href="#" id="go-button">Fight!</a>

    </div>
    <footer>
        <audio id="soundEffects">
          <source src="effects.ogg" type="audio/ogg">
        </audio>
    </footer>
    <script type="text/javascript" src="script.js"></script>
    <script type="text/javascript">
    var selected_items = [];

    var soundEffects = new Audio('effects.ogg');

    $(".card").click(function(e){
        e.preventDefault();

        // $(this).toggleClass('flip');
        // $(this).toggleClass('selected');

        var clicked_card_name = $(this).attr('data-name');
          if (selected_items && selected_items.indexOf(clicked_card_name) >=0) {
            var index = selected_items.indexOf(clicked_card_name);

             selected_items.splice(index, 1);

             $(this).removeClass('selected');
          }
          else if (selected_items && selected_items.length >= 2){

          }
          else {

            selected_items.push(clicked_card_name);
            $(this).addClass('selected');
          }

    });

        $('#go-button').click(function(e){
          e.preventDefault();
          if (selected_items && selected_items.length ==2) {
            $('.card:not(.selected)').fadeOut();
            $('.card.selected').addClass('large');
            $('.card.large').removeClass('selected');
            $('#go-button').hide();
            $("html, body").animate({ scrollTop: 0 }, 500);
            $('#quote').html(setQuote());
            $('#quote').fadeIn(function(){
              setTimeout(function(){
                $('#quote').fadeOut();
                $('.card.large').addClass("flip");
              },5000);
            });

            setTimeout(function(){
              $('#overlay').fadeIn(function(){
                //perform animation and sound
                $('#overlay').addClass('active');
                soundEffects.play();
                  setTimeout(function(){
                    $('#overlay').fadeOut();
                    $('#winner span').html(calculateWinner() + '!');
                    $('#winner').fadeIn();
                  }, 6000);
              });
            },5000);
          }
          else {
            alert('Please select 2 cards!!!');
          }

        });

        function calculateWinner() {


          if (selected_items.length == 2) {
            var first_contender_name = selected_items[0];
            var second_contender_name = selected_items[1];
            var first_contender_powers = characters.find(x=> x.name === first_contender_name).powers;
            var second_contender_powers = characters.find(x=> x.name === second_contender_name).powers;
            var first_contender_nicename = characters.find(x=> x.name === first_contender_name).nicename;
            var second_contender_nicename = characters.find(x=> x.name === second_contender_name).nicename;
            var first_score = first_contender_powers.reduce((a, b) => a + b, 0);
            var second_score = second_contender_powers.reduce((a, b) => a + b, 0);
            if (first_score > second_score) {
              return first_contender_nicename;
            }
            else if (first_score < second_score) {
              return second_contender_nicename;
            }
            else {
              return 'a draw'

            }
          }
          else {
            return 'a draw'
          }
        }

        function setQuote() {
          if (selected_items.length == 2) {
            var first_contender_name = selected_items[0];
            var second_contender_name = selected_items[1];
            var first_contender_blackcardstart = characters.find(x=> x.name === first_contender_name).blackcardstart;
            var first_contender_blackcardend = characters.find(x=> x.name === first_contender_name).blackcardend;
            var second_contender_whitecard = characters.find(x=> x.name === second_contender_name).whitecard;
            var quote = first_contender_blackcardstart + ' <span>' + second_contender_whitecard + ' </span>' + first_contender_blackcardend;
            return quote;
          }
        }
    </script>


</body>
</html>
